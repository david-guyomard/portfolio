/***********************************************************\
|* Website: https://www.djordjejocic.com                   *|
|* Author: Djordje Jocic <office@djordjejocic.com>         *|
|* License: MIT License (MIT)                              *|
|* ------------------------------------------------------- *|
|* Permission is hereby granted, free of charge, to any    *|
|* person obtaining a copy of this software and associated *|
|* documentation files (the "Software"), to deal in the    *|
|* Software  without restriction, including without        *|
|* limitation the rights to use, copy, modify, merge,      *|
|* publish, distribute, sublicense, and/or sell copies of  *|
|* the Software, and to permit persons to whom the         *|
|* Software is furnished to do so, subject to the          *|
|* following conditions:                                   *|
|* ------------------------------------------------------- *|
|* The above copyright notice and this permission notice   *|
|* shall be included in all copies or substantial portions *|
|* of the Software.                                        *|
|* ------------------------------------------------------- *|
|* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT  WARRANTY OF  *|
|* ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED *|
|* TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A     *|
|* PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT     *|
|* SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR    *|
|* ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN    *|
|* ACTION OF CONTRACT, TORT OR OTHERWISE, RISING FROM, OUT *|
|* OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR     *|
|* OTHER DEALINGS IN THE SOFTWARE.                         *|
|* ------------------------------------------------------- *|
|* Copyright (C) 2018                                      *|
\***********************************************************/

function ParallaxRenderer(){this.render=function(a,l,r){if(r.parallaxInit){var e=this.calculateParallaxRatio(a,r.start,r.end);a-=l.offset().top;var t=-Math.floor(e*r.offset),n=this.parsePosition(l.css("background-position"));n.left+="px",n.top=t+"px",l.css("background-position",n.left+" "+n.top)}},this.parseLocation=function(a){return a.trim().replace(/^((url\()+(`|'|"))/,"").replace(/((`|'|")+(\)))$/,"")},this.parsePosition=function(a){var l={left:0,top:0};return a=a.replace(/[^0-9\s]/g,"").trim().split(" ",2),l.left=a[0],l.top=a[1],l},this.clamp=function(a,l,r){return a<l?l:r<a?r:a},this.calculateOffset=function(a,l){if(l.height>=a.height)return 0;var r=l.width()/a.width;return Math.floor(a.height*r)-l.height()},this.calculateParallaxRatio=function(a,l,r){return(a-=l=l<0?0:l)/(r-=l)}}!function(t){t.fn.parallaxCore={scrollDefault:[],scrollManual:[],countDefault:0,countManual:0,refreshTimeout:null,renderer:new ParallaxRenderer},t.fn.parallax=function(a){var l=t(this);if(void 0===t(this).data("parallaxSettings")){var r=new Image,e=t("<div />",{class:"parallax-preloader",style:"display: none;"});void 0===a&&(a={image:null,height:null,billboard:!0,scroll:"default"}),a.parallaxInit=!0,r.onload=function(){e.remove(),a.offset=t.fn.parallaxCore.renderer.calculateOffset(r,l),l.data("parallaxSettings",a),"default"===a.scroll?(t.fn.parallaxCore.scrollDefault.push(l),t.fn.parallaxCore.countDefault++):"manual"===a.scroll&&(t.fn.parallaxCore.scrollManual.push(l),t.fn.parallaxCore.countManual++)},e.appendTo(l),setTimeout(function(){e.show()},1e3),null==a.image?r.src=t.fn.parallaxCore.renderer.parseLocation(l.css("background-image")):(l.css({"background-image":"url("+a.image+")","background-size":"100% auto"}),r.src=a.image),null==a.height?a.height=l.height():l.height(a.height),a.start=l.offset().top-t(window).height(),a.end=l.height()+l.offset().top}},t.fn.parallaxScroll=function(a){var l=t(this),r=t(this).data("parallaxSettings");t.isEmptyObject(r)||a>=r.start&&a<=r.end&&t.fn.parallaxCore.renderer.render(a,l,r)},t(document).scroll(function(){for(var a=t(this).scrollTop(),l=null,r=null,e=0;e<t.fn.parallaxCore.countDefault;e++)l=t.fn.parallaxCore.scrollDefault[e],a>=(r=t.fn.parallaxCore.scrollDefault[e].data("parallaxSettings")).start&&a<=r.end&&t.fn.parallaxCore.renderer.render(a,l,r)}),t(window).resize(function(){null==t.fn.parallaxCore.refreshTimeout&&(t.fn.parallaxCore.refreshTimeout=setTimeout(function(){for(var a=null,l=null,r=0;r<t.fn.parallaxCore.countDefault;r++)a=t.fn.parallaxCore.scrollDefault[r],(l=t.fn.parallaxCore.scrollDefault[r].data("parallaxSettings")).start=a.offset().top-t(window).height(),t.fn.parallaxCore.scrollDefault[r].data("parallaxSettings",l);for(r=0;r<t.fn.parallaxCore.countManual;r++)a=t.fn.parallaxCore.scrollManual[r],(l=t.fn.parallaxCore.scrollManual[r].data("parallaxSettings")).start=a.offset().top-t(window).height(),t.fn.parallaxCore.scrollManual[r].data("parallaxSettings",l);t.fn.parallaxCore.refreshTimeout=null},1e3))})}(jQuery);